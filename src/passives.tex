\documentclass[main.tex]{subfiles}
\begin{document}

\section{Determine the step response of the following circuits.}

\noindent State any assumptions regarding component values.

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0, 4) node[anchor=east] {$V_{in}$};
            \draw (0, 4) to[resistor, l=$R$] (5, 4);
            \draw (5, 4) node[right] {$V_{out}$};
            \draw (-0.5, 2) -- (5.5, 2); % ground line at the bottom
            \draw (3, 2) node[ground]{};
            \label{ct:series_resistor}
        \end{circuitikz}
        \caption{Circuit A}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0, 4) node[anchor=east] {$V_{in}$};
            \draw (0, 4) to[resistor, l=$R_1$] (5, 4); % top resistor to the left, horizontal
            \draw (3.5, 4) to[resistor, l=$R_2$] (3.5, 2); % bottom resistor, vertical
            \draw (5, 4) node[right] {$V_{out}$};
            \draw (-0.5, 2) -- (5.5, 2); % ground line at the bottom
            \draw (3, 2) node[ground]{};
            \label{fig:voltage_divider}
        \end{circuitikz}
        \caption{Circuit B}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0, 4) node[anchor=east] {$V_{in}$};
            \draw (0, 4) to[resistor, l=$R$] (5, 4);
            \draw (3.5, 4) to[capacitor, l=$C$] (3.5, 2);
            \draw (5, 4) node[right] {$V_{out}$};
            \draw (-0.5, 2) -- (5.5, 2);
            \draw (3, 2) node[ground]{};
            \label{fig:rc_low_pass_filter}
        \end{circuitikz}
        \caption{Circuit C}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0, 4) node[anchor=east] {$V_{in}$};
            \draw (0, 4) to[capacitor, l=$C$] (5, 4);
            \draw (3.5, 4) to[resistor, l=$R$] (3.5, 2);
            \draw (5, 4) node[right] {$V_{out}$};
            \draw (-0.5, 2) -- (5.5, 2);
            \draw (3, 2) node[ground]{};
            \label{fig:rc_high_pass_filter}
        \end{circuitikz}
        \caption{Circuit D}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0,0) to[isource, l=$I_{in}$] (0,3) -- (2,3) to[C=$C$] (2,0) -- (0,0);
            \draw (2, 3) node[right] {$V_{out}$};
            \draw (1, 0) node[ground]{};
            \label{fig:c_current_source}
        \end{circuitikz}
        \caption{Circuit E}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0,0) to[isource, l=$I_{in}$] (0,3);
            \draw (0, 3) to[resistor, l=$R$] (3, 3);
            \draw (3, 3) node[right] {$V_{out}$};
            \draw (3, 3) to[capacitor, l=$C$] (3, 0);
            \draw (3, 0) -- (0, 0);
            \draw(1.5, 0) node[ground]{};
            \label{fig:rc_current_source}
        \end{circuitikz}
        \caption{Circuit F}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0, 4) node[anchor=east] {$V_{in}$};
            \draw (0, 4) to[inductor, l=$L$] (5, 4);
            \draw (3.5, 4) to[capacitor, l=$C$] (3.5, 2);
            \draw (5, 4) node[right] {$V_{out}$};
            \draw (-0.5, 2) -- (5.5, 2);
            \draw (3, 2) node[ground]{};
            \label{fig:lseries_cshunt}
        \end{circuitikz}
        \caption{Circuit G}
    \end{center}
\end{figure}

\begin{figure}[h!]
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0, 4) node[anchor=east] {$V_{in}$};
            \draw (0, 4) -- (0.75, 4);
            \draw (0.75, 4) to[inductor, l=$L$] (2.5, 4);
            \draw (2.5, 4) to [capacitor, l=$C$] (4.25, 4);
            \draw (4.25, 4) -- (5, 4);
            \draw (5, 4) node[right] {$V_{out}$};
            \draw (-0.5, 2) -- (5.5, 2);
            \draw (3, 2) node[ground]{};
            \label{fig:lseries_cseries}
        \end{circuitikz}
        \caption{Circuit H}
    \end{center}
\end{figure}

% Add in G but with series resistor after the L

\spoilerline

\noindent For a question like this, assuming ideal components is expected as further information has not been provided to aid in a more complex analysis. In a real interview you would likely be given just one of these circuits.
% Numerous circuits are analyzed for the sake of building intuition and the showing first principles approach.

\subsection{Passives}
Ideal passives Figure \ref{fig:passive definitions}:
\begin{figure}[h!]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
         & Resistor & Capacitor & Inductor \\ \hline
        Time Domain & $V = I \cdot R$ & $I = C \cdot \frac{dv}{dt}$ & $V = L \cdot \frac{di}{dt}$ \\ \hline
        Frequency Domain & $Z = R$ & $Z = \frac{1}{j \cdot \omega \cdot C}$ & $Z = j \cdot \omega \cdot L$ \\ \hline
        At $f \approx \inf$ & $Z = R$ & $Z \approx 0$ & $Z \approx \inf$ \\ \hline
        At $f \approx 0$ & $Z = R$ & $Z \approx \inf$ & $Z \approx 0$ \\ \hline
        Energy Stored & $E = 0$ & $E = \frac{1}{2} \cdot C \cdot V^{2}$ & $E = \frac{1}{2} \cdot L \cdot I^{2}$ \\ \hline
        Real Power Dissipation & $P = I \cdot V$ & $P = 0$ & $P = 0$ \\ \hline
    \end{tabular}
    \caption{Passive Element Definitions}
    \label{fig:passive definitions}
\end{figure}
Keep in mind when interpreting Figure \ref{fig:passive definitions} that:
\begin{itemize}
    \item The relationship between angular frequency and frequency is given by: $\omega = 2 \cdot \pi \cdot f$.
    \item $Z = \frac{V}{I}$ represents the impedance of a circuit. 
    \item Impedance, $Z$, is frequency dependent for circuits with inductors and capacitors.
    \item The imaginary component of impedance, $Z$, represents reactance $X$ which defines a phase shift between $V$ and $I$.
    \item Resistors have no frequency dependence and do not store any energy.
    \item An open circuit, nets that are completely isolated from each other, are represented as connected by $Z = \inf$.
    \item A short circuit, nets that are at the same voltage potential, are represented as connected by $Z = 0$. 
    \item For circuits, say $Z_1$, $Z_2$, ..., $Z_n$, in series the equivalent impedance is given by $Z = Z_1 + Z_2 + ... + Z_n$.
    \item For circuits, say $Z_1$, $Z_2$, ..., $Z_n$, in parallel the equivalent impedance is given by $\frac{1}{Z} = \frac{1}{Z_1} + \frac{1}{Z_2} + ... + \frac{1}{Z_n}$.
    \item For two circuits in parallel, say $Z_1$ and $Z_2$, $\frac{1}{Z} = \frac{1}{Z_1} + \frac{1}{Z_2}$ can be simplified into $Z = \frac{Z_1 \cdot Z_2}{Z_1 + Z_2}$ algebraically.  
\end{itemize}

\subsection{Step Response}
Step response of a circuit is what the output waveform with respect to time looks like given a unit step function is applied to the input. Traditionally this means plotting $V_{out}$ waveform given 

\[
    V_{in}(t) =
    \begin{cases} 
        0 & t < 0, \\
        1 & t \geq 0.
    \end{cases}
\]

In the laplace domain the unit step function is given by $V_{in}(j \cdot \omega) = \frac{1}{j \cdot \omega}$. To determine the response of a circuit in the laplace domain, $V_{out}(j \cdot \omega) = V_{in}{j \cdot \omega} * H(j \cdot \omega)$ where $H(j \cdot \omega)$ defines the system transfer function.

% TODO Add a plot in the frequency domain showing the step response and explain implications to above passives

\subsection{Circuit A: Series Resistor}
In this circuit we note Ohm's law, $V = I \cdot R$, however, as there is no load, $I=0$ on the resistor in this circuit we note there is no voltage drop, $V=I \cdot R=0 \cdot R=0$, across the resistor, consequently $V_{in} = V_{out}$ for this circuit. 

% DRAW PLOT : showing an input step being followed perfectly

\subsection{Circuit B: Voltage Divider}
This circuit is a voltage divider depicted slightly differently than in a previous question, but the same equations hold: $\frac{V_{out}}{V_{in}} = \frac{R_2}{R_1 + R_2}$. In this case, to produce a step response plot an assumption is required about the values of $R_1$ and $R_2$. For simplicity, it is assumed that $R_1 = R_2$, resulting in the following transfer function: $\frac{V_{out}}{V_{in}} = 1/2$.

% DRAW PLOT : of V_{out}

\subsection{Circuit C: RC Low Pass Filter}
From the two elements in the circuit we get in the time domain $I = C \cdot \frac{dV_{out}}{dt}$ and $V_{in} - V_{out} = I \cdot R$. Cancelling out $I$ which is equivalent in both elements we get $V_{in} - V_{out} = R \cdot C \cdot \frac{dV_{out}}{dt}$ which can be algebraically manipulated into $-\frac{dV_{out}}{V_{out}-V_{in}} = -\frac{dt}{R \cdot C}$ where we perform the integral on each side revealing $\ln{\frac{V_{out}-V_{in}}{V_out}}=-\frac{t}{R \cdot C}$ which can be algebraically manipulated into $V_{out}=V_{in} \cdot (1-e^{\frac{-t}{R \cdot C}})$. Note when analyzing this circuit we commonly define a constant $\tau = R \cdot C$ as the time constant of the RC circuit which represents the time it takes $1-e^{-1}$ or ~63 percent of the step size. As the question allows us to choose component values for the components I will assume $R$ and $C$ are chosen such that $\tau = R \cdot C = 1$ for simplicity.

% DRAW PLOT : add a nice solution plot showing an exponential rise and some key points labelled, notably time constant 

This circuit can also be analyzed in the frequency domain. In this case for the capacitor $Z_c = \frac{1}{j \cdot \omega \cdot c}$ and for the resistor $Z_r = R$. For the voltage divider, $\frac{V_{out}}{V_{in}} = \frac{R_2}{R_1 + R_2}$, can be extrapolated into $\frac{V_{out}}{V_{in}} = \frac{Z_2}{Z_1 + Z_2}$ so by substituting in the values for this circuit $H = \frac{V_{out}}{V_{in}} = \frac{Z_c}{Z_r + Z_c} = \frac{\frac{1}{j \cdot \omega \cdot c}}{R + \frac{1}{j \cdot \omega \cdot c}} = \frac{1}{1 + j \cdot \omega \cdot c \cdot R} = \frac{1}{1+\frac{j \cdot \omega}{\omega_{0}}}$ where $\omega_{0} = \frac{1}{R \cdot C}$ is defined is a pole of the system transfer function $H$. Plotting this single pole low pass filter reveals:

% DRAW PLOT : frequency domain plot of this circuit in log log scale 

To find the step response using the laplace domain $V_{out}(j \cdot \omega) = H(j \cdot \omega) \cdot \frac{1}{j \cdot w}$ is applied and then an inverse laplace transformation reveals an identical solution to the time domain solution.

This circuit is extremely fundamental and has implications for numerous situations. Consider an I2C digital signal in which all drivers are not asserting the line low. In this case the signal trace has some parasitic capacitance to ground and a pullup resistor is responsible for pulling the line to a logic high state. This can be modelled as an RC circuit and consequently a real I2C signal showing states $0101010101$ in reality appear as follows on an oscilloscope:

% DRAW PLOT : I2C signal with real rise time s

Increasing the value of $R_{pullup}$ results in less power consumption, but slower rise times as $\tau = R \cdot C$. There is often a lower limit to the value of $R_{pullup}$ as drivers must be rated for the current to pull the line low. Selecting the value of $R_{pullup}$ is a careful consideration for design engineers with values commonly ranging from $1 k \Omega$ to $10 k \Omega$.
% This is a really strong paragraph! I really want people to understand these tradeoffs! 

% TODO : Add in a current plot for the RC step response as well, this is sometimes asked

When answering a question like this a conceptual sanity check is also useful! As a capacitor behaves like an open circuit in DC it makes sense that as time approaches infinity, Circuit C begins to look like Circuit A! 

\subsection{Circuit D: RC High Pass Filter}

\subsection{Circuit E: Series Capacitor with Current Source}

\subsection{Circuit F: Series RC with Current Source}

\subsection{Circuit G: Series Inductor with Shunt Capacitor}
When analyzing this circuit, begin with considering what happens as $t \approx \inf$ and $t \approx 0$ as these are the simplest states. For all of $t \leq 0$ it is reasonable to assume there is no energy stored in the passives, $E_l = 0$ and $E_c = 0$, and consequently $V_{out} = 0$ is a valid initial condition. When $t \approx \inf$ it is known that $Z_l \approx \inf$ and $Z_c \approx \inf$ as time increases there are significantly less high frequency components present. This means as $t \approx \inf$ Circuit G begins to appear as Circuit A. 

% TODO math proof quickly

% Plot
% label midpoint of oscillation as V_in
% label max as 2*Vin and the min as 0 

% TODO explain resonant frequency formula

% TODO explain rise waveform is based on L and C values 

\subsection{Circuit H: Series Inductor and Capacitor}

\subsection{Follow-ups}
\begin{itemize}
    \item Given an unknown discrete capacitor find the capacitance? How would you determine the capacitance at a given DC bias voltage?
\end{itemize}

\end{document}
